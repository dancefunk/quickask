import{_ as n,o as s,c as a,a as e}from"./app-d0ac87ef.js";const t="/dist/assets/images/article/2021/comment.png",l={},i=e(`<h3 id="数据库表结构" tabindex="-1"><a class="header-anchor" href="#数据库表结构" aria-hidden="true">#</a> 数据库表结构</h3><table><thead><tr><th style="text-align:left;">字段</th><th style="text-align:left;">描述</th></tr></thead><tbody><tr><td style="text-align:left;">id</td><td style="text-align:left;">主键</td></tr><tr><td style="text-align:left;">pid</td><td style="text-align:left;">上级ID</td></tr><tr><td style="text-align:left;">level</td><td style="text-align:left;">评论等级</td></tr></tbody></table><h3 id="封装递归函数" tabindex="-1"><a class="header-anchor" href="#封装递归函数" aria-hidden="true">#</a> 封装递归函数</h3><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token keyword">function</span> <span class="token function-definition function">get_childs_comment</span><span class="token punctuation">(</span><span class="token variable">$comments</span><span class="token punctuation">,</span> <span class="token variable">$parent_id</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token variable">$level</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token variable">$new_comments</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$comments</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=&gt;</span> <span class="token variable">$val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$val</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;pid&#39;</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token variable">$parent_id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$val</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;level&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$level</span><span class="token punctuation">;</span>
            <span class="token variable">$val</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;childs&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">get_childs_comment</span><span class="token punctuation">(</span><span class="token variable">$comments</span><span class="token punctuation">,</span> <span class="token variable">$val</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;id&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$level</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$new_comments</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$val</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
 
    <span class="token keyword">return</span> <span class="token variable">$new_comments</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>返回出来的数据结构如下：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>[
    &#39;一级评论&#39;,
    &#39;childs&#39; =&gt; [
        &#39;二级评论&#39;
        &#39;childs&#39; =&gt; [
            &#39;....&#39;
        ]
    ]
]
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这种结构就是在数组中无限创建子元素childs那么要注意了，在页面输出的时候也是要用递归的方式来输出才行</p><h3 id="另一种方式-利用level层级字段" tabindex="-1"><a class="header-anchor" href="#另一种方式-利用level层级字段" aria-hidden="true">#</a> 另一种方式，利用level层级字段</h3><p>我们可以在数据库中记录level层级字段，表示1层，2层，3层，从而来加<code>padding-left</code>内边距，来实现评论层级的效果</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>level=0  说明是顶级评论  padding-left 0
level=1  说明是一级评论  padding-left 20
level=2  说明是二级评论  padding-left 40
....依次类推,就可以实现下图的结构，但是这种方式是存在bug的，如果要是不是顺序评论的话，那么层级就会错乱
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+t+'" alt="comment"></p>',11),p=[i];function c(o,d){return s(),a("div",null,p)}const u=n(l,[["render",c],["__file","PHPshixianwuxianjipinglun.html.vue"]]);export{u as default};
