import{_ as n,o as s,c as a,a as t}from"./app-88c1fa71.js";const p={},e=t(`<h3 id="使用composer安装" tabindex="-1"><a class="header-anchor" href="#使用composer安装" aria-hidden="true">#</a> 使用composer安装</h3><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code>composer <span class="token keyword">require</span> phpoffice<span class="token operator">/</span>phpspreadsheet
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="github下载" tabindex="-1"><a class="header-anchor" href="#github下载" aria-hidden="true">#</a> GitHub下载</h3><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code>https<span class="token punctuation">:</span><span class="token comment">//github.com/PHPOffice/PhpSpreadsheet</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="案例代码" tabindex="-1"><a class="header-anchor" href="#案例代码" aria-hidden="true">#</a> 案例代码</h3><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">require_once</span> <span class="token constant">__DIR__</span> <span class="token operator">.</span> <span class="token string single-quoted-string">&#39;/vendor/autoload.php&#39;</span><span class="token punctuation">;</span>

<span class="token comment">// excel文件导出</span>
<span class="token keyword">function</span> <span class="token function-definition function">export</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">//定义数据结构</span>
    <span class="token variable">$datalist</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;name&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;张三&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;sex&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;男&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;age&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;20&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;email&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;123@qq.com&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;name&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;李四&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;sex&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;男&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;age&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;30&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;email&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;12312@qq.com&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;name&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;王五&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;sex&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;男&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;age&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;40&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;email&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;1233@qq.com&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;name&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;小兰&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;sex&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;女&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;age&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;50&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;email&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;1253@qq.com&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token comment">// 定义表头</span>
    <span class="token variable">$title</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;昵称&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;性别&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;年龄&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;邮箱&#39;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
 
    <span class="token comment">// 创建xls表格对象</span>
    <span class="token variable">$spreadsheet</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified"><span class="token punctuation">\\</span>PhpOffice<span class="token punctuation">\\</span>PhpSpreadsheet<span class="token punctuation">\\</span>Spreadsheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$sheet</span> <span class="token operator">=</span> <span class="token variable">$spreadsheet</span><span class="token operator">-&gt;</span><span class="token function">getActiveSheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
    <span class="token comment">//设置表头单元格内容</span>
    <span class="token variable">$TitleCol</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&#39;A&#39;</span><span class="token punctuation">;</span>
    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$title</span> <span class="token keyword">as</span> <span class="token variable">$item</span><span class="token punctuation">)</span> 
    <span class="token punctuation">{</span>
        <span class="token comment">// 单元格内容写入</span>
        <span class="token variable">$sheet</span><span class="token operator">-&gt;</span><span class="token function">setCellValue</span><span class="token punctuation">(</span><span class="token variable">$TitleCol</span><span class="token operator">.</span><span class="token string single-quoted-string">&#39;1&#39;</span><span class="token punctuation">,</span> <span class="token variable">$item</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$TitleCol</span><span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 从第二行开始 写入内容</span>
    <span class="token variable">$row</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$datalist</span> <span class="token keyword">as</span> <span class="token variable">$item</span><span class="token punctuation">)</span> 
    <span class="token punctuation">{</span>
        <span class="token variable">$DataCol</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&#39;A&#39;</span><span class="token punctuation">;</span>
        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$item</span> <span class="token keyword">as</span> <span class="token variable">$value</span><span class="token punctuation">)</span> 
        <span class="token punctuation">{</span>
            <span class="token comment">// 单元格内容写入</span>
            <span class="token variable">$sheet</span><span class="token operator">-&gt;</span><span class="token function">setCellValue</span><span class="token punctuation">(</span><span class="token variable">$DataCol</span><span class="token operator">.</span><span class="token variable">$row</span><span class="token punctuation">,</span> <span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$DataCol</span><span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token variable">$row</span><span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token function">date</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;YmdHis&#39;</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">&quot;.xls&quot;</span><span class="token punctuation">;</span>

    <span class="token comment">// 设置输出xls的头信息 直接下载文件</span>
    <span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Content-Disposition: attachment;filename=&quot;&#39;</span> <span class="token operator">.</span> <span class="token variable">$filename</span> <span class="token operator">.</span> <span class="token string single-quoted-string">&#39;&quot;&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Cache-Control: max-age=0&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Cache-Control: cache, must-revalidate&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Pragma: public&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$writer</span> <span class="token operator">=</span> <span class="token class-name class-name-fully-qualified static-context"><span class="token punctuation">\\</span>PhpOffice<span class="token punctuation">\\</span>PhpSpreadsheet<span class="token punctuation">\\</span>IOFactory</span><span class="token operator">::</span><span class="token function">createWriter</span><span class="token punctuation">(</span><span class="token variable">$spreadsheet</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;Xls&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$writer</span><span class="token operator">-&gt;</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;php://output&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">exit</span><span class="token punctuation">;</span>

    <span class="token comment">// 保存文件到本地</span>
    <span class="token comment">// $writer = \\PhpOffice\\PhpSpreadsheet\\IOFactory::createWriter($spreadsheet, &#39;Xls&#39;);</span>
    <span class="token comment">// $writer-&gt;save($filename);</span>
    <span class="token comment">// exit;</span>
<span class="token punctuation">}</span>

<span class="token comment">// excel读取</span>
<span class="token keyword">function</span> <span class="token function-definition function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&#39;./demo.xls&#39;</span><span class="token punctuation">;</span>
    <span class="token variable">$spreadsheet</span> <span class="token operator">=</span> <span class="token class-name class-name-fully-qualified static-context"><span class="token punctuation">\\</span>PhpOffice<span class="token punctuation">\\</span>PhpSpreadsheet<span class="token punctuation">\\</span>IOFactory</span><span class="token operator">::</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$SheetData</span> <span class="token operator">=</span> <span class="token variable">$spreadsheet</span><span class="token operator">-&gt;</span><span class="token function">getActiveSheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token constant">null</span><span class="token punctuation">,</span> <span class="token constant boolean">true</span><span class="token punctuation">,</span> <span class="token constant boolean">true</span><span class="token punctuation">,</span> <span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token variable">$SheetData</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">export</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token delimiter important">?&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="基本方法使用" tabindex="-1"><a class="header-anchor" href="#基本方法使用" aria-hidden="true">#</a> 基本方法使用</h3><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">PhpOffice<span class="token punctuation">\\</span>PhpSpreadsheet<span class="token punctuation">\\</span>Spreadsheet</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">PhpOffice<span class="token punctuation">\\</span>PhpSpreadsheet<span class="token punctuation">\\</span>Worksheet<span class="token punctuation">\\</span>Drawing</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">PhpOffice<span class="token punctuation">\\</span>PhpSpreadsheet<span class="token punctuation">\\</span>Style<span class="token punctuation">\\</span>Alignment</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">PhpOffice<span class="token punctuation">\\</span>PhpSpreadsheet<span class="token punctuation">\\</span>Style<span class="token punctuation">\\</span>Fill</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">PhpOffice<span class="token punctuation">\\</span>PhpSpreadsheet<span class="token punctuation">\\</span>Style<span class="token punctuation">\\</span>Border</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">PhpOffice<span class="token punctuation">\\</span>PhpSpreadsheet<span class="token punctuation">\\</span>Style<span class="token punctuation">\\</span>Color</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">PhpOffice<span class="token punctuation">\\</span>PhpSpreadsheet<span class="token punctuation">\\</span>IOFactory</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">PhpOffice<span class="token punctuation">\\</span>PhpSpreadsheet<span class="token punctuation">\\</span>Helper<span class="token punctuation">\\</span>Html</span> <span class="token keyword">as</span> HtmlHelper<span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">PhpOffice<span class="token punctuation">\\</span>PhpSpreadsheet<span class="token punctuation">\\</span>Cell<span class="token punctuation">\\</span>DataType</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">PhpOffice<span class="token punctuation">\\</span>PhpSpreadsheet<span class="token punctuation">\\</span>Worksheet<span class="token punctuation">\\</span>PageSetup</span><span class="token punctuation">;</span>
 
<span class="token variable">$spreadsheet</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Spreadsheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//新建文件</span>
<span class="token comment">// $spreadSheet = IOFactory::load($inputFileName); //载入文件</span>
<span class="token variable">$sheet</span> <span class="token operator">=</span> <span class="token variable">$spreadsheet</span><span class="token operator">-&gt;</span><span class="token function">getActiveSheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//$spreadSheet-&gt;getProperties()-&gt;setCreator(&quot;hellow&quot;);//设置作者</span>
<span class="token comment">//$spreadSheet-&gt;getSheetCount();//工作表总数</span>
<span class="token comment">//$spreadSheet-&gt;getSheetNames();//工作表名数组</span>
<span class="token comment">//$sheet = $spreadSheet-&gt;getSheetByName(&#39;Sheet1&#39;);//根据表名获取工作表</span>
<span class="token comment">//$sheet = $spreadSheet-&gt;getSheet(0);//根据表索引获取工作表</span>
<span class="token comment">//$sheet = $spreadSheet-&gt;setActiveSheetIndex(0);//切换当前工作表</span>
<span class="token comment">//$sheet = $spreadsheet-&gt;setActiveSheetIndexByName(&#39;DataSheet&#39;)</span>
 
<span class="token comment">//设置打印选项</span>
<span class="token variable">$sheet</span><span class="token operator">-&gt;</span><span class="token function">getPageSetup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">setFitToWidth</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$sheet</span><span class="token operator">-&gt;</span><span class="token function">getPageSetup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">setFitToHeight</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$sheet</span><span class="token operator">-&gt;</span><span class="token function">getPageSetup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">setOrientation</span><span class="token punctuation">(</span><span class="token class-name static-context">PageSetup</span><span class="token operator">::</span><span class="token constant">ORIENTATION_LANDSCAPE</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">setPaperSize</span><span class="token punctuation">(</span><span class="token class-name static-context">PageSetup</span><span class="token operator">::</span><span class="token constant">PAPERSIZE_A4</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token variable">$sheet</span><span class="token operator">-&gt;</span><span class="token function">getPageMargins</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">setTop</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">setRight</span><span class="token punctuation">(</span><span class="token number">0.75</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">setLeft</span><span class="token punctuation">(</span><span class="token number">0.75</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">setBottom</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$sheet</span><span class="token operator">-&gt;</span><span class="token function">getPageSetup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">setHorizontalCentered</span><span class="token punctuation">(</span><span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">setVerticalCentered</span><span class="token punctuation">(</span><span class="token constant boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$sheet</span><span class="token operator">-&gt;</span><span class="token function">setPrintGridlines</span><span class="token punctuation">(</span><span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$sheet</span><span class="token operator">-&gt;</span><span class="token function">getPageSetup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">setPrintArea</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;A1:E5,G4:M20&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token comment">//设置缩放</span>
<span class="token variable">$sheet</span><span class="token operator">-&gt;</span><span class="token function">getSheetView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">setZoomScale</span><span class="token punctuation">(</span><span class="token number">75</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//设置worksheet的颜色</span>
<span class="token variable">$sheet</span><span class="token operator">-&gt;</span><span class="token function">getTabColor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">setRGB</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;FF0000&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//设置worksheet名字</span>
<span class="token variable">$sheet</span><span class="token operator">-&gt;</span><span class="token function">setTitle</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;sheet 1&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token comment">//设置默认样式</span>
<span class="token variable">$spreadsheet</span><span class="token operator">-&gt;</span><span class="token function">getDefaultStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getFont</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Arial&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$spreadsheet</span><span class="token operator">-&gt;</span><span class="token function">getDefaultStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getFont</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">setSize</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token comment">//获取文档所有值</span>
<span class="token variable">$data</span> <span class="token operator">=</span> <span class="token variable">$sheet</span><span class="token operator">-&gt;</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//获取最大行数 </span>
<span class="token variable">$res</span> <span class="token operator">=</span> <span class="token variable">$sheet</span><span class="token operator">-&gt;</span><span class="token function">getHighestRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//获取最大列数 </span>
<span class="token variable">$res</span> <span class="token operator">=</span> <span class="token variable">$sheet</span><span class="token operator">-&gt;</span><span class="token function">getHighestColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token comment">//单元格信息</span>
<span class="token variable">$cell</span> <span class="token operator">=</span> <span class="token variable">$sheet</span><span class="token operator">-&gt;</span><span class="token function">getCellByColumnAndRow</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//获取单元格 B1</span>
<span class="token variable">$cell</span> <span class="token operator">=</span> <span class="token variable">$sheet</span><span class="token operator">-&gt;</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;A1&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//获取单元格A1</span>
<span class="token variable">$cell</span><span class="token operator">-&gt;</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//获取单元格的数据值</span>
<span class="token variable">$cell</span><span class="token operator">-&gt;</span><span class="token function">getCoordinate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//获取行列信息 A1</span>
<span class="token variable">$column</span> <span class="token operator">=</span> <span class="token variable">$cell</span><span class="token operator">-&gt;</span><span class="token function">getColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//获取列信息 A</span>
<span class="token variable">$row</span>   <span class="token operator">=</span> <span class="token variable">$cell</span><span class="token operator">-&gt;</span><span class="token function">getRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//获取行信息 1</span>
<span class="token variable">$cell</span><span class="token operator">-&gt;</span><span class="token function">getDataType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//获取数据类型</span>
<span class="token variable">$cell</span><span class="token operator">-&gt;</span><span class="token function">setValue</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;8888&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置值</span>
<span class="token variable">$cell</span><span class="token operator">-&gt;</span><span class="token function">getStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getFont</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//单元格样式</span>
 
<span class="token comment">//设置行高</span>
<span class="token variable">$sheet</span><span class="token operator">-&gt;</span><span class="token function">getDefaultRowDimension</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">setRowHeight</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;mm&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$sheet</span><span class="token operator">-&gt;</span><span class="token function">getRowDimension</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">setRowHeight</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;mm&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//设置列宽</span>
<span class="token comment">// $sheet-&gt;getColumnDimension(&#39;A&#39;)-&gt;setAutoSize(true);</span>
<span class="token comment">//$sheet-&gt;getColumnDimension(&#39;A&#39;)-&gt;setWidth(300);//设置A列的宽度</span>
<span class="token variable">$sheet</span><span class="token operator">-&gt;</span><span class="token function">getDefaultColumnDimension</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">setWidth</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置列默认宽度</span>
 
<span class="token comment">//设置换行</span>
<span class="token variable">$sheet</span><span class="token operator">-&gt;</span><span class="token function">setCellValue</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;A2&#39;</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">&quot;hellow\\nphp&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置换行 双引号+\\n+setWrapText</span>
<span class="token variable">$sheet</span><span class="token operator">-&gt;</span><span class="token function">getStyle</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;A2&#39;</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getAlignment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">setWrapText</span><span class="token punctuation">(</span><span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置换行</span>
 
<span class="token comment">//合并拆分单元格</span>
<span class="token variable">$sheet</span><span class="token operator">-&gt;</span><span class="token function">mergeCells</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;B2:B3&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// $sheet-&gt;unmergeCells(&#39;B2:B3&#39;);</span>
 
<span class="token comment">//设置值</span>
<span class="token comment">// $sheet-&gt;setCellValue(&#39;A1&#39;, &quot;hellow\\nphp&quot;);</span>
<span class="token variable">$sheet</span><span class="token operator">-&gt;</span><span class="token function">setCellValueByColumnAndRow</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;6666&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置B2的值</span>
<span class="token comment">// $sheet-&gt;fromArray($arr, null, &#39;D5&#39;); //数组,空值时填充值,开始单元格坐标</span>
 
<span class="token comment">//设置超链接</span>
<span class="token variable">$sheet</span><span class="token operator">-&gt;</span><span class="token function">setCellValue</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;B3&#39;</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">&quot;百度&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置A链接</span>
<span class="token variable">$sheet</span><span class="token operator">-&gt;</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;B3&#39;</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getHyperlink</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">setUrl</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;https://www.baidu.com&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// $sheet-&gt;setCellValue(&#39;E26&#39;, &#39;www.phpexcel.net&#39;);</span>
<span class="token comment">// $sheet-&gt;getCell(&#39;E26&#39;)-&gt;getHyperlink()-&gt;setUrl(&quot;sheet://&#39;Sheetname&#39;!A1&quot;);</span>
 
<span class="token comment">//设置字体粗细大小颜色</span>
<span class="token variable">$sheet</span><span class="token operator">-&gt;</span><span class="token function">getStyle</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;B3&#39;</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getFont</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">setBold</span><span class="token punctuation">(</span><span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Arial&#39;</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">setSize</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$sheet</span><span class="token operator">-&gt;</span><span class="token function">getStyle</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;B3&#39;</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getFont</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//字体名</span>
<span class="token variable">$sheet</span><span class="token operator">-&gt;</span><span class="token function">getStyle</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;B3&#39;</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getFont</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getColor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">setRGB</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;#AEEEEE&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置颜色</span>
<span class="token variable">$sheet</span><span class="token operator">-&gt;</span><span class="token function">getStyle</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;B3&#39;</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getFont</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getColor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getRGB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//获取颜色值</span>
<span class="token variable">$sheet</span><span class="token operator">-&gt;</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;C3&#39;</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">setValue</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;2021-03-27 23:22:59&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//$sheet-&gt;getStyle(&#39;D2&#39;)-&gt;getNumberFormat()-&gt;setFormatCode(NumberFormat::FORMAT_DATE_DDMMYYYY);//设置日期格式 </span>
<span class="token variable">$sheet</span><span class="token operator">-&gt;</span><span class="token function">getStyle</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;D3&#39;</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getNumberFormat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">setFormatCode</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;dd/mm/yyyy&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置日期格式 与上文相同</span>
 
 
<span class="token comment">//设置单元格背景色</span>
<span class="token variable">$sheet</span><span class="token operator">-&gt;</span><span class="token function">getStyle</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;E3&#39;</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getFill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">setFillType</span><span class="token punctuation">(</span><span class="token class-name static-context">Fill</span><span class="token operator">::</span><span class="token constant">FILL_SOLID</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getStartColor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">setARGB</span><span class="token punctuation">(</span><span class="token class-name static-context">Color</span><span class="token operator">::</span><span class="token constant">COLOR_GREEN</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token comment">//设置单元格对齐方式</span>
<span class="token variable">$sheet</span><span class="token operator">-&gt;</span><span class="token function">getStyle</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;B2&#39;</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getAlignment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">setHorizontal</span><span class="token punctuation">(</span><span class="token class-name static-context">Alignment</span><span class="token operator">::</span><span class="token constant">HORIZONTAL_CENTER</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$sheet</span><span class="token operator">-&gt;</span><span class="token function">getStyle</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;B2&#39;</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getAlignment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">setVertical</span><span class="token punctuation">(</span><span class="token class-name static-context">Alignment</span><span class="token operator">::</span><span class="token constant">VERTICAL_CENTER</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token comment">//设置单元格边框</span>
<span class="token variable">$sheet</span><span class="token operator">-&gt;</span><span class="token function">getStyle</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;C2:E2&#39;</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getBorders</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getBottom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">setBorderStyle</span><span class="token punctuation">(</span><span class="token class-name static-context">Border</span><span class="token operator">::</span><span class="token constant">BORDER_THIN</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token comment">//富文本</span>
<span class="token variable">$html</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&#39;bold, italic, bold+italic&#39;</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token variable">$wizard</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HtmlHelper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$richText</span> <span class="token operator">=</span> <span class="token variable">$wizard</span><span class="token operator">-&gt;</span><span class="token function">toRichTextObject</span><span class="token punctuation">(</span><span class="token variable">$html</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$sheet</span><span class="token operator">-&gt;</span><span class="token function">setCellValue</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;D5&#39;</span><span class="token punctuation">,</span> <span class="token variable">$richText</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token comment">//公式</span>
<span class="token variable">$sheet</span><span class="token operator">-&gt;</span><span class="token function">setCellValue</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;A4&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;=IF(C4&gt;500,&quot;profit&quot;,&quot;loss&quot;)&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// $formula = $sheet-&gt;getCell(&#39;A4&#39;)-&gt;getValue();</span>
<span class="token comment">// $value = $sheet-&gt;getCell(&#39;A4&#39;)-&gt;getCalculatedValue();</span>
 
<span class="token comment">//插入删除行列</span>
<span class="token variable">$sheet</span><span class="token operator">-&gt;</span><span class="token function">insertNewRowBefore</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$sheet</span><span class="token operator">-&gt;</span><span class="token function">removeRow</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token comment">//写入图片</span>
<span class="token variable">$drawing</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Drawing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$drawing</span><span class="token operator">-&gt;</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Logo&#39;</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">setDescription</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Logo&#39;</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">setPath</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;../files/1.jpg&#39;</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">setHeight</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">setCoordinates</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;D6&#39;</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">setOffsetX</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">setOffsetY</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$drawing</span><span class="token operator">-&gt;</span><span class="token function">setRotation</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$drawing</span><span class="token operator">-&gt;</span><span class="token function">getShadow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">setVisible</span><span class="token punctuation">(</span><span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$drawing</span><span class="token operator">-&gt;</span><span class="token function">getShadow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">setDirection</span><span class="token punctuation">(</span><span class="token number">45</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token variable">$drawing</span><span class="token operator">-&gt;</span><span class="token function">setWorksheet</span><span class="token punctuation">(</span><span class="token variable">$sheet</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token comment">//设置单元格数据类型</span>
<span class="token variable">$sheet</span><span class="token operator">-&gt;</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;A1&#39;</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">setValueExplicit</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;25&#39;</span><span class="token punctuation">,</span> <span class="token class-name static-context">DataType</span><span class="token operator">::</span><span class="token constant">TYPE_NUMERIC</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token comment">//格式</span>
<span class="token variable">$styleArray</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string single-quoted-string">&#39;font&#39;</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>
        <span class="token string single-quoted-string">&#39;bold&#39;</span> <span class="token operator">=&gt;</span> <span class="token constant boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string single-quoted-string">&#39;alignment&#39;</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>
        <span class="token string single-quoted-string">&#39;horizontal&#39;</span> <span class="token operator">=&gt;</span> <span class="token class-name static-context">Alignment</span><span class="token operator">::</span><span class="token constant">HORIZONTAL_RIGHT</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string single-quoted-string">&#39;borders&#39;</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>
        <span class="token string single-quoted-string">&#39;top&#39;</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>
            <span class="token string single-quoted-string">&#39;borderStyle&#39;</span> <span class="token operator">=&gt;</span> <span class="token class-name static-context">Border</span><span class="token operator">::</span><span class="token constant">BORDER_THIN</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string single-quoted-string">&#39;fill&#39;</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>
        <span class="token string single-quoted-string">&#39;fillType&#39;</span> <span class="token operator">=&gt;</span> <span class="token class-name class-name-fully-qualified static-context"><span class="token punctuation">\\</span>PhpOffice<span class="token punctuation">\\</span>PhpSpreadsheet<span class="token punctuation">\\</span>Style<span class="token punctuation">\\</span>Fill</span><span class="token operator">::</span><span class="token constant">FILL_GRADIENT_LINEAR</span><span class="token punctuation">,</span>
        <span class="token string single-quoted-string">&#39;rotation&#39;</span> <span class="token operator">=&gt;</span> <span class="token number">90</span><span class="token punctuation">,</span>
        <span class="token string single-quoted-string">&#39;startColor&#39;</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>
            <span class="token string single-quoted-string">&#39;argb&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;FFA0A0A0&#39;</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string single-quoted-string">&#39;endColor&#39;</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>
            <span class="token string single-quoted-string">&#39;argb&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;FFFFFFFF&#39;</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&#39;01simple.xlsx&#39;</span><span class="token punctuation">;</span>
<span class="token variable">$sheet</span><span class="token operator">-&gt;</span><span class="token function">getStyle</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;A5:E5&#39;</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">applyFromArray</span><span class="token punctuation">(</span><span class="token variable">$styleArray</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token comment">// // 保存xlsx在本地</span>
<span class="token comment">// $writer = IOFactory::createWriter($spreadsheet, &#39;Xlsx&#39;);</span>
<span class="token comment">// $writer-&gt;save(&#39;01simple.xlsx&#39;);</span>
 
<span class="token comment">// 下载xlsx</span>
<span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Content-Disposition: attachment;filename=&quot;&#39;</span> <span class="token operator">.</span> <span class="token variable">$filename</span> <span class="token operator">.</span> <span class="token string single-quoted-string">&#39;&quot;&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Cache-Control: max-age=0&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Cache-Control: max-age=1&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Expires: Mon, 26 Jul 1997 05:00:00 GMT&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Date in the past</span>
<span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Last-Modified: &#39;</span> <span class="token operator">.</span> <span class="token function">gmdate</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;D, d M Y H:i:s&#39;</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string single-quoted-string">&#39; GMT&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// always modified</span>
<span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Cache-Control: cache, must-revalidate&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// HTTP/1.1</span>
<span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Pragma: public&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// HTTP/1.0</span>
<span class="token variable">$writer</span> <span class="token operator">=</span> <span class="token class-name static-context">IOFactory</span><span class="token operator">::</span><span class="token function">createWriter</span><span class="token punctuation">(</span><span class="token variable">$spreadsheet</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;Xlsx&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$writer</span><span class="token operator">-&gt;</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;php://output&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">exit</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,8),o=[e];function c(l,i){return s(),a("div",null,o)}const r=n(p,[["render",c],["__file","16.html.vue"]]);export{r as default};
