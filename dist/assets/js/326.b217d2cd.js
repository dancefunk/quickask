(window.webpackJsonp=window.webpackJsonp||[]).push([[326],{903:function(e,s,a){"use strict";a.r(s);var t=a(5),n=Object(t.a)({},(function(){var e=this,s=e.$createElement,a=e._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h3",{attrs:{id:"快速生成模块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#快速生成模块"}},[e._v("#")]),e._v(" 快速生成模块")]),e._v(" "),a("blockquote",[a("ul",[a("li",[e._v("表示自动生成test模块，自动生成的模块目录包含了config、controller、model和view目录以及common.php公共文件。")])])]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("php think build --module test\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("h3",{attrs:{id:"快速生成控制器类"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#快速生成控制器类"}},[e._v("#")]),e._v(" 快速生成控制器类")]),e._v(" "),a("blockquote",[a("ul",[a("li",[e._v("执行下面的指令可以生成 index模块的 Blog控制器类库文件")])])]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("php think make:controller index/Blog\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("h3",{attrs:{id:"快速生成模型类"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#快速生成模型类"}},[e._v("#")]),e._v(" 快速生成模型类")]),e._v(" "),a("blockquote",[a("ul",[a("li",[e._v("执行下面的指令可以生成 index 模块的 Blog 模型类库文件")])])]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("php think make:model index/Blog\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("h3",{attrs:{id:"快速生成类库映射文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#快速生成类库映射文件"}},[e._v("#")]),e._v(" 快速生成类库映射文件")]),e._v(" "),a("blockquote",[a("ul",[a("li",[e._v("可以使用下面的指令生成类库映射文件，提高系统自动加载的性能。")])])]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("php think optimize:autoload\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("p",[e._v("指令执行成功后，会在rumtime目录下面生成classmap.php文件，生成的类库映射文件会扫描系统目录和 应用目录的类库")]),e._v(" "),a("h3",{attrs:{id:"生成路由缓存"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#生成路由缓存"}},[e._v("#")]),e._v(" 生成路由缓存")]),e._v(" "),a("blockquote",[a("ul",[a("li",[e._v("optimize:route如果你的应用定义了比较多的路由规则，可以使用下面的指令生成路由缓存文件，提高系统的路由检测的性能")])])]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("php think optimize:route\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("p",[e._v("指令执行成功后，会在rumtime目录下面生成route.php 文件，生成的路由缓存文件仅仅支持在应用的路由配置文件中定义的路由（包括方法定义和配置定义）")]),e._v(" "),a("h3",{attrs:{id:"清除缓存文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#清除缓存文件"}},[e._v("#")]),e._v(" 清除缓存文件")]),e._v(" "),a("blockquote",[a("ul",[a("li",[a("ol",[a("li",[e._v("如果需要清除应用的缓存文件，可以使用下面的命令：")])])])])]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("php think clear\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("p",[e._v("不带任何参数调用clear命令的话，会清除 runtime 目录（包括模板缓存、日志文件及其子目录）下面的所 有的文件，但会保留目录。")]),e._v(" "),a("blockquote",[a("ul",[a("li",[e._v("2)如果需要清除某个指定目录下面的文件，可以使用：")])])]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("php think clear --path d:\\www\\tp5\\runtime\\log\\\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("h3",{attrs:{id:"生成配置缓存文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#生成配置缓存文件"}},[e._v("#")]),e._v(" 生成配置缓存文件")]),e._v(" "),a("blockquote",[a("ul",[a("li",[e._v("1)可以为应用或者模块生成配置缓存文件")])])]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("php think optimize:config\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("p",[e._v("默认生成应用的配置缓存文件，调用后会在"),a("code",[e._v("runtime")]),e._v("目录下面生成"),a("code",[e._v("init.php")]),e._v("文件，生成配置缓存文件 后，应用目录下面的"),a("code",[e._v("config.php")]),e._v(" "),a("code",[e._v("common.php")]),e._v("以及"),a("code",[e._v("tags.php")]),e._v("不会被加载，被 "),a("code",[e._v("runtime/init.php")]),e._v(" 取代。")]),e._v(" "),a("blockquote",[a("ul",[a("li",[e._v("2)如果需要生成某个模块的配置缓存，可以使用：")])])]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("php think optimize:config --module index\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("p",[e._v("调用后会在"),a("code",[e._v("runtime/index")]),e._v("目录下面生成"),a("code",[e._v("init.php")]),e._v("文件，生成后，"),a("code",[e._v("index")]),e._v("模块目录下面的 "),a("code",[e._v("config.php common.php")]),e._v("以及"),a("code",[e._v("tags.php")]),e._v("不会被加载，被"),a("code",[e._v("runtime/index/init.php")]),e._v("取代")]),e._v(" "),a("h3",{attrs:{id:"生成数据表字段缓存"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#生成数据表字段缓存"}},[e._v("#")]),e._v(" 生成数据表字段缓存")]),e._v(" "),a("blockquote",[a("ul",[a("li",[e._v("1)可以通过生成数据表字段信息缓存，提升数据库查询的性能，避免多余的查询。命令如下：")])])]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("php think optimize:schema\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("p",[e._v("会自动生成当前数据库配置文件中定义的数据表字段缓存，也可以指定数据库生成字段缓存（必须有用户权限），例如，下面指定生成demo数据库下面的所有数据表的字段缓存信息")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("php think optimize:schema --db demo\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("p",[e._v("执行后会自动在'runtime/schema'目录下面按照数据表生成字段缓存文件。")]),e._v(" "),a("p",[e._v("如果你的应用使用了不同的数据库连接，可以根据模块来生成，如下：")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("php think optimize:schema --module index\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("p",[e._v("会读取index模块的模型来生成数据表字段缓存。")]),e._v(" "),a("p",[e._v("更新数据表字段缓存也是同样的方式，每次执行都会重新生成缓存。如果需要单独更新某个数据表的缓存， 可以使用：")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("php think optimize:schema --table think_user\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("p",[e._v("支持指定数据库名称")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("php think optimize:schema --table demo.think_user\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("h3",{attrs:{id:"创建自定义命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建自定义命令"}},[e._v("#")]),e._v(" 创建自定义命令")]),e._v(" "),a("blockquote",[a("ul",[a("li",[a("ol",[a("li",[e._v("首先在配置文件：application/command.php")])])])])]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("return [  \n    'app\\home\\command\\Test'  \n];  \n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br")])]),a("p",[e._v("配置自定义的命令行的namespace。")]),e._v(" "),a("blockquote",[a("ul",[a("li",[e._v("2.创建自定义的命令行")])])]),e._v(" "),a("p",[e._v("我在home模块中的command创建一个Test.php的文件，这里要特别注意，因为是命令行跑，要特别注意文件名的大小写，我一开始的时候没有注意到这个，文件名用了小写，结果一直跑不出来命令。")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("namespace app\\home\\command;  \n  \nuse think\\console\\Command;  \nuse think\\console\\Input;  \nuse think\\console\\Output;  \n  \nclass Test extends Command  \n{  \n    protected function configure()  \n    {  \n        $this->setName('test')->setDescription('Command Test');  \n    }  \n  \n    protected function execute(Input $input, Output $output)  \n    {  \n        $output->writeln(\"TestCommand:\");  \n    }  \n}  \n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br"),a("span",{staticClass:"line-number"},[e._v("8")]),a("br"),a("span",{staticClass:"line-number"},[e._v("9")]),a("br"),a("span",{staticClass:"line-number"},[e._v("10")]),a("br"),a("span",{staticClass:"line-number"},[e._v("11")]),a("br"),a("span",{staticClass:"line-number"},[e._v("12")]),a("br"),a("span",{staticClass:"line-number"},[e._v("13")]),a("br"),a("span",{staticClass:"line-number"},[e._v("14")]),a("br"),a("span",{staticClass:"line-number"},[e._v("15")]),a("br"),a("span",{staticClass:"line-number"},[e._v("16")]),a("br"),a("span",{staticClass:"line-number"},[e._v("17")]),a("br"),a("span",{staticClass:"line-number"},[e._v("18")]),a("br")])]),a("p",[e._v("讲解一下，这个文件是集成Think底层的Command类的，configure函数是在命令行中用list命令列出所有任务的时候回显示的出的提示，execute函数是说要执行的命令，在这里可以直接调用其他函数，完成例如统计等任务工作，然后用output输出到命令行。")]),e._v(" "),a("p",[e._v("最后，在根目录中有一个think.php的文件，这个是命令行的入口，文件名可以随意改。代码如下")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("// 定义项目路径  \ndefine('APP_PATH', './application/');  \n  \n// 加载框架引导文件  \nrequire './thinkphp/console.php';  \n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br")])]),a("p",[e._v("然后输入"),a("code",[e._v("php think test")]),e._v("， 这样就会显示出结果了。")])])}),[],!1,null,null,null);s.default=n.exports}}]);